<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Invoice Maker</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<style>
body {
  font-family: Arial, sans-serif;
  background: #f2f2f2;
  padding: 20px;
}
.container {
  max-width: 800px;
  background: #fff;
  padding: 20px;
  margin: auto;
  border-radius: 8px;
}
h1, h3 {
  text-align: center;
}
input {
  width: 100%;
  padding: 8px;
  margin: 5px 0;
}
table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 10px;
}
th, td {
  border: 1px solid #ccc;
  padding: 8px;
  text-align: center;
}
.total {
  font-size: 18px;
  font-weight: bold;
  text-align: right;
  margin-top: 10px;
}
button {
  padding: 10px 15px;
  margin-top: 10px;
  cursor: pointer;
}
.invoice {
  display: none;
}
.signature {
  margin-top: 50px;
}
</style>
</head>

<body>

<div class="container">
  <h1>RV Graphic Design</h1>
  <h3>We turn your dream design</h3>

  <label>Date</label>
  <input id="date" readonly>

  <label>Invoice No</label>
  <input id="invoiceNo" readonly>

  <label>Customer Name</label>
  <input id="customerName">

  <label>Customer Address</label>
  <input id="customerAddress">

  <label>Phone Number</label>
  <input id="customerPhone">

  <h3>Item Details</h3>

  <table>
    <tr>
      <th>Item</th>
      <th>Qty</th>
      <th>Unit Price</th>
      <th>Total</th>
    </tr>
    <tr>
      <td><input id="itemName"></td>
      <td><input id="qty" type="number" oninput="calculate()"></td>
      <td><input id="price" type="number" oninput="calculate()"></td>
      <td id="itemTotal">0.00</td>
    </tr>
  </table>

  <div class="total">
    Grand Total: LKR <span id="grandTotal">0.00</span>
  </div>

  <button onclick="saveAndGenerate()">Save & Generate PDF</button>
</div>

<!-- PDF INVOICE -->
<div id="invoice" class="invoice">
  <h1>RV Graphic Design</h1>
  <p>We turn your dream design</p>
  <hr>

  <p><b>Invoice No:</b> <span id="pInvoice"></span></p>
  <p><b>Date:</b> <span id="pDate"></span></p>

  <p><b>Customer:</b> <span id="pName"></span></p>
  <p><b>Address:</b> <span id="pAddress"></span></p>
  <p><b>Phone:</b> <span id="pPhone"></span></p>

  <table>
    <tr>
      <th>Item</th>
      <th>Qty</th>
      <th>Unit Price</th>
      <th>Total</th>
    </tr>
    <tr>
      <td id="pItem"></td>
      <td id="pQty"></td>
      <td id="pPrice"></td>
      <td id="pTotal"></td>
    </tr>
  </table>

  <h3>Total: LKR <span id="pGrand"></span></h3>

  <div class="signature">
    _________________________<br>
    Owner â€“ RV Graphic Design
  </div>
</div>

<script>
const scriptURL = "PASTE_GOOGLE_SCRIPT_URL_HERE";

document.getElementById("date").value = new Date().toISOString().slice(0,10);
document.getElementById("invoiceNo").value =
  "INV-" + Date.now().toString().slice(-5);

function calculate() {
  let q = document.getElementById("qty").value || 0;
  let p = document.getElementById("price").value || 0;
  let t = q * p;
  document.getElementById("itemTotal").innerText = t.toFixed(2);
  document.getElementById("grandTotal").innerText = t.toFixed(2);
}

function saveAndGenerate() {
  let data = {
    invoiceNo: invoiceNo.value,
    date: date.value,
    customerName: customerName.value,
    address: customerAddress.value,
    phone: customerPhone.value,
    item: itemName.value,
    qty: qty.value,
    unitPrice: price.value,
    total: grandTotal.innerText
  };

  fetch(scriptURL, {
    method: "POST",
    body: JSON.stringify(data)
  });

  document.getElementById("pInvoice").innerText = data.invoiceNo;
  document.getElementById("pDate").innerText = data.date;
  document.getElementById("pName").innerText = data.customerName;
  document.getElementById("pAddress").innerText = data.address;
  document.getElementById("pPhone").innerText = data.phone;
  document.getElementById("pItem").innerText = data.item;
  document.getElementById("pQty").innerText = data.qty;
  document.getElementById("pPrice").innerText = data.unitPrice;
  document.getElementById("pTotal").innerText = data.total;
  document.getElementById("pGrand").innerText = data.total;

  document.getElementById("invoice").style.display = "block";

  html2pdf().from(document.getElementById("invoice")).save(
    data.invoiceNo + ".pdf"
  );
}
</script>

</body>
</html>
